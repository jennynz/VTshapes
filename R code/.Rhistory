source('~/Part IV Project/R code/readAreaFunctions_12VT1Set.R', echo=TRUE)
.libPaths('H:/Documents/Rlibraries')
library('emuR')
# Normalise for maximum area in each shape to eliminate interspeaker effects
# Excluding first column X1 because of unreliability of first frame of MRI images (lips are usually poorly defined), and last column X29
# e.g. VT09 shapes much bigger than others.
maxArea=apply(allSpeakers.df[,4:30],1,max)
pca <- prcomp(~., data=na.omit(allSpeakers.df[,4:30]/maxArea), scale=T)
pca.summ <- summary(pca)
levels(allSpeakers.df$vow)= c("æ", "ɑː", "e", "iː", "ɜː", "ɪ", "ɔː", "ɒ", "ʊ", "ʌ", "uː")
levels(allSpeakers.df$vow
)
colpalette = c("firebrick4","chocolate4","darkgoldenrod","chartreuse4","aquamarine4","darkcyan","deepskyblue4","darkslateblue","darkorchid4","deeppink4","indianred4")
# Plot of PC1 and PC2, centroids only
plot.new()
eplot(pca$x[,1:2], labs=as.character(allSpeakers.df[,2]), centroid=T, formant=T, col=T, xlim=c(-4,4), ylim=c(-4,4))
title(main="Centroids of combined vowel properties from 12 vocal tracts", xlab="PC1", ylab="PC2")
# Plot of PC1 and PC2, all vowels
plot.new()
eplot(pca$x[,1:2], labs=as.character(allSpeakers.df[,2]), centroid=F, formant=T, col=T, xlim=c(-7,6), ylim=c(-6,6))
text(pca$x[,1],pca$x[,2],labels=allSpeakers.df[,2])
title(main="Combined vowel properties from 12 vocal tracts", xlab="PC1", ylab="PC2")
# Plot of standard deviations
plot(1:length(pca$sdev),pca$sdev,type="p", xlab="Principal component #", ylab="Standard deviation")
title(main="Standard deviations of principal components from combined dataset")
# Plot of proportions of variance
pca.var <- pca.summ$importance[2,]
plot(1:length(pca.var),pca.var, type="p", xlab="Principal component #", ylab="% Variance")
title(main="Proportion of variance explained by principal components")
pca.summ
plot.new()
eplot(pca$x[,1:2], labs=as.character(allSpeakers.df[,2]), centroid=F, formant=T, col=colpalette, doellipse = T, dopoints = T)
title(main = "Vowel properties (12 VTs x 1 Sets)", xlab = "PC1", ylab = "PC2")
# Plot of PC1 and PC2, centroids only
plot.new()
eplot(pca$x[,1:2], labs=as.character(allSpeakers.df[,2]), centroid=T, formant=T, col=colpalette, doellipse = T)
title(main = "Centroids of combined vowel properties (12 VTs x 1 Set)", xlab = "PC1", ylab = "PC2")
# Plot of standard deviations
plot(pca$sdev, type="p", xlab="Principal component #", ylab="Standard deviation")
title(main = "Standard deviations of principal components from combined dataset (12 VTs x 1 Set)")
# Plot of proportions of variance
pca.var <- pca.summ$importance[2,]
plot(pca.var, type="p", xlab="Principal component #", ylab="% Variance")
title(main = "Proportion of variance explained by principal components (12 VTs x 1 Set)")
# Plot of PC1 and PC2, all vowels
eplot(pca$x[,1:2], labs=as.character(allSpeakers.df[,2]), centroid=F, formant=T, col=colpalette, doellipse = T, dopoints = T)
title(main = "Vowel properties (12 VTs x 1 Sets)", xlab = "PC1", ylab = "PC2")
# Plot of PC1 and PC2, centroids only
eplot(pca$x[,1:2], labs=as.character(allSpeakers.df[,2]), centroid=T, formant=T, col=colpalette, doellipse = T)
title(main = "Centroids of combined vowel properties (12 VTs x 1 Set)", xlab = "PC1", ylab = "PC2")
# Plot of standard deviations
plot(pca$sdev, type="p", xlab="Principal component #", ylab="Standard deviation")
title(main = "Standard deviations of principal components from combined dataset (12 VTs x 1 Set)")
# Plot of proportions of variance
pca.var <- pca.summ$importance[2,]
plot(pca.var, type="p", xlab="Principal component #", ylab="% Variance")
title(main = "Proportion of variance explained by principal components (12 VTs x 1 Set)")
eplot(pca$x[,1:2], labs=as.character(allSpeakers.df[,2]), centroid=F, formant=T, col=colpalette, doellipse = F, dopoints = T)
eplot(pca$x[,1:2], labs=as.character(allSpeakers.df[,2]), centroid=F, formant=T, col=colpalette, doellipse = T, dopoints = T)
pca.summ
pca.var
pca.var[1]+pca.var[2]
eplot(pca$x[,1:2], labs=as.character(allSpeakers.df[,2]), centroid=F, formant=T, col=colpalette, doellipse = T, dopoints = T, ylim = c(-7,7))
eplot(pca$x[,1:2], labs=as.character(allSpeakers.df[,2]), centroid=F, formant=T, col=colpalette, doellipse = T, dopoints = T, xlim = c(-7,7))
eplot(pca$x[,1:2], labs=as.character(allSpeakers.df[,2]), centroid=F, formant=T, col=colpalette, doellipse = T, dopoints = T, xlim = c(-7,7), ylim = c(-6, 6))
eplot(pca$x[,1:2], labs=as.character(allSpeakers.df[,2]), centroid=F, formant=T, col=colpalette, doellipse = T, dopoints = T, xlim = c(-6,), ylim = c(-6, 6))
eplot(pca$x[,1:2], labs=as.character(allSpeakers.df[,2]), centroid=F, formant=T, col=colpalette, doellipse = T, dopoints = T, xlim = c(-6,6), ylim = c(-6, 6))
eplot(pca$x[,1:2], labs=as.character(allSpeakers.df[,2]), centroid=F, formant=T, col=colpalette, doellipse = F, dopoints = T, xlim = c(-6,6), ylim = c(-6, 6))
eplot(pca$x[,1:2], labs=as.character(allSpeakers.df[,2]), centroid=F, formant=F, col=colpalette, doellipse = F, dopoints = T, xlim = c(-6,6), ylim = c(-6, 6))
eplot(pca$x[,1:2], labs=as.character(allSpeakers.df[,2]), centroid=F, formant=T, col=colpalette, doellipse = F, dopoints = T, xlim = c(-6,6), ylim = c(-6, 6))
title(main = "Vowel properties (12 VTs x 1 Sets)", xlab = "PC1", ylab = "PC2")
eplot(pca$x[,1:2], labs=as.character(allSpeakers.df[,2]), centroid=F, formant=F, col=colpalette, doellipse = F, dopoints = T, xlim = c(-6,6), ylim = c(-6, 6))
allSpeakers.df
allSpeakers.df[14,]
allSpeakers.df[14,3:]
allSpeakers.df[14,-1:2]
allSpeakers.df[14,-(1:2)]
plot(allSpeakers.df[14,-(1:2)])
levels(allSpeakers.df[14,-(1:2)])
typeof(allSpeakers.df[14,-(1:2)])
length(allSpeakers.df[14,-(1:2)])
plot(1:29, allSpeakers.df[14,-(1:2)])
help(plot)
plot(1:29, allSpeakers.df[14,-(1:2)], type="l")
plot(1:29, allSpeakers.df[14,-(1:2)], type="l", col="red")
dir(paste(path,VTlist[2],"distance_area",sep="\\"))
dir(paste(path,VTlist[2],"distance_area",sep="\\"))[3]
vt02e <- dir(paste(path,VTlist[2],"distance_area",sep="\\"))[3]
vt02e <- unlist(strsplit(vt02e, "\\."))
vt02e
dir(paste(path,VTlist[2],"distance_area",sep="\\"))
vt02e <- dir(paste(path,VTlist[2],"distance_area",sep="\\"))[3]
vt02e <- read.table(dir(paste(path,VTlist[2],"distance_area",sep="\\"))[3])
vt02e <- read.table(paste(path,VTlist[2],"distance_area",sep="\\"))[3])
paste(path,VTlist[2],"distance_area",sep="\\")[3]
paste(path,VTlist[2],"distance_area",sep="\\")
paste(path,VTlist[2],"distance_area","head.txt",sep="\\")
read.table(paste(path,VTlist[2],"distance_area","head.txt",sep="\\"))
vt02e <- read.table(paste(path,VTlist[2],"distance_area","head.txt",sep="\\"))
lines(vt02e, col="blue")
vt02e[,2]
lines(vt02e[,2], col="blue")
length(vt02e[,2])
legend(1,25,c("Interpolated on R","Interpolated in MATLAB"), lty=c(1,1))
plot (c(0,29),c(0,300),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(allSpeakers.df[14,-(1:2)], col="red")
vt02e <- read.table(paste(path,VTlist[2],"distance_area","head.txt",sep="\\"))
lines(vt02e[,2], col="blue")
title(main = "VT02 e vowel area functions")
legend(1,50,c("Interpolated on R and MATLAB","Interpolated in MATLAB only"), lty=c(1,1))
lines(allSpeakers.df[14,-(1:2)], col="red")
allSpeakers.df[14,-(1:2)]
unlist(allSpeakers.df[14,-(1:2)])
lines(unlist(vt02e[,2]), col="blue")
lines(unlist(allSpeakers.df[14,-(1:2)]), col="red")
vt02e <- read.table(paste(path,VTlist[2],"distance_area","head.txt",sep="\\"))
lines(vt02e[,2], col="blue")
title(main = "VT02 e vowel area functions")
plot (c(0,29),c(0,300),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(unlist(allSpeakers.df[14,-(1:2)]), col="red")
vt02e <- read.table(paste(path,VTlist[2],"distance_area","head.txt",sep="\\"))
lines(vt02e[,2], col="blue")
title(main = "VT02 e vowel area functions")
legend(0.5,40,c("Interpolated on R and MATLAB","Interpolated in MATLAB only"), lty=c(1,1))
legend(0,40,c("Interpolated on R and MATLAB","Interpolated in MATLAB only"), lty=c(1,1))
graphics.off() # close all graphics windows
rm(list=ls()) # clear workspace
source('~/Part IV Project/R code/readAreaFunctions_12VT1Set.R', echo=TRUE)
source('~/Part IV Project/R code/readAreaFunctions_12VT1Set.R', echo=TRUE)
.libPaths('H:/Documents/Rlibraries')
library('emuR')
# Normalise for maximum area in each shape to eliminate interspeaker effects
# Excluding first column X1 because of unreliability of first frame of MRI images (lips are usually poorly defined), and last column X29
# e.g. VT09 shapes much bigger than others.
maxArea=apply(allSpeakers.df[,4:30],1,max)
pca <- prcomp(~., data=na.omit(allSpeakers.df[,4:30]/maxArea), scale=T)
pca.summ <- summary(pca)
levels(allSpeakers.df$vow)= c("æ", "ɑː", "e", "iː", "ɜː", "ɪ", "ɔː", "ɒ", "ʊ", "ʌ", "uː")
colpalette = c("firebrick4","chocolate4","darkgoldenrod","chartreuse4","aquamarine4","darkcyan","deepskyblue4","darkslateblue","darkorchid4","deeppink4","indianred4")
# Plot of PC1 and PC2, all vowels
eplot(pca$x[,1:2], labs=as.character(allSpeakers.df[,2]), centroid=F, formant=T, col=colpalette, doellipse = T, dopoints = T)
title(main = "Vowel properties (12 VTs x 1 Sets)", xlab = "PC1", ylab = "PC2")
# Compare with old 12VT1Set plot where hood was huddled in corner.
eplot(pca$x[,1:2], labs=as.character(allSpeakers.df[,2]), centroid=F, formant=T, col=colpalette, doellipse = F, dopoints = T, xlim = c(-6,6), ylim = c(-6, 6))
title(main = "Vowel properties (12 VTs x 1 Sets)", xlab = "PC1", ylab = "PC2")
# Plot of PC1 and PC2, centroids only
eplot(pca$x[,1:2], labs=as.character(allSpeakers.df[,2]), centroid=T, formant=T, col=colpalette, doellipse = T)
title(main = "Centroids of combined vowel properties (12 VTs x 1 Set)", xlab = "PC1", ylab = "PC2")
# Plot of standard deviations
plot(pca$sdev, type="p", xlab="Principal component #", ylab="Standard deviation")
title(main = "Standard deviations of principal components from combined dataset (12 VTs x 1 Set)")
# Plot of proportions of variance
pca.var <- pca.summ$importance[2,]
plot(pca.var, type="p", xlab="Principal component #", ylab="% Variance")
title(main = "Proportion of variance explained by principal components (12 VTs x 1 Set)")
# Comparing linearly interpolated area function with
plot (c(0,29),c(0,300),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(unlist(allSpeakers.df[14,-(1:2)]), col="red")
vt02e <- read.table(paste(path,VTlist[2],"distance_area","head.txt",sep="\\"))
lines(vt02e[,2], col="blue")
title(main = "VT02 e vowel area functions")
legend(0,40,c("Interpolated on R and MATLAB","Interpolated in MATLAB only"), lty=c(1,1))
unlist(allSpeakers.df[14,-(1:2)])
vt02e[,2]
allSpeakers.df
unlist(allSpeakers.df[89,-(1:2)])
plot (c(0,29),c(0,300),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(unlist(allSpeakers.df[89,-(1:2)]), col="red")
vt02e <- read.table(paste(path,VTlist[9],"distance_area","had.txt",sep="\\"))
lines(vt02e[,2], col="blue")
title(main = "VT09 had vowel area functions")
legend(0,40,c("Interpolated on R and MATLAB","Interpolated in MATLAB only"), lty=c(1,1))
00),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(unlist(allSpeakers.df[89,-(1:2)]), col="red")
vt02e <- read.table(paste(path,VTlist[9],"distance_area","had.txt",sep="\\"))
lines(vt02e[,2], col="blue")
title(main = "VT09 had vowel area functions")
legend(0,40,c("Inte
plot (c(0,29),c(0,500),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(unlist(allSpeakers.df[89,-(1:2)]), col="red")
vt02e <- read.table(paste(path,VTlist[9],"distance_area","had.txt",sep="\\"))
lines(vt02e[,2], col="blue")
title(main = "VT09 had vowel area functions")
legend(0,40,c("Interpolated on R and MATLAB","Interpolated in MATLAB only"), lty=c(1,1))
plot (c(0,29),c(0,500),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(unlist(allSpeakers.df[89,-(1:2)]), col="red")
vt02e <- read.table(paste(path,VTlist[9],"distance_area","had.txt",sep="\\"))
lines(vt02e[,2], col="blue")
title(main = "VT09 had vowel area functions")
legend(0,40,c("Interpolated on R and MATLAB","Interpolated in MATLAB only"), lty=c(1,1))
plot (c(0,29),c(0,600),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(unlist(allSpeakers.df[89,-(1:2)]), col="red")
vt02e <- read.table(paste(path,VTlist[9],"distance_area","had.txt",sep="\\"))
lines(vt02e[,2], col="blue")
title(main = "VT09 had vowel area functions")
legend(0,80,c("Interpolated on R and MATLAB","Interpolated in MATLAB only"), lty=c(1,1))
plot (c(0,29),c(0,650),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(unlist(allSpeakers.df[89,-(1:2)]), col="red")
vt02e <- read.table(paste(path,VTlist[9],"distance_area","had.txt",sep="\\"))
lines(vt02e[,2], col="blue")
title(main = "VT09 had vowel area functions")
legend(0,100,c("Interpolated on R and MATLAB","Interpolated in MATLAB only"), lty=c(1,1))
plot (c(0,29),c(0,700),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(unlist(allSpeakers.df[89,-(1:2)]), col="red")
vt02e <- read.table(paste(path,VTlist[9],"distance_area","had.txt",sep="\\"))
lines(vt02e[,2], col="blue")
title(main = "VT09 had vowel area functions")
legend(0,100,c("Interpolated on R and MATLAB","Interpolated in MATLAB only"), lty=c(1,1))
title(main = "VT09 'had' vowel area functions")
plot (c(0,29),c(0,300),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(unlist(allSpeakers.df[14,-(1:2)]), col="red")
vt02e <- read.table(paste(path,VTlist[2],"distance_area","head.txt",sep="\\"))
lines(vt02e[,2], col="blue")
title(main = "VT02 'head' vowel area functions")
legend(0,40,c("Interpolated on R and MATLAB","Interpolated in MATLAB only"), lty=c(1,1))
# VT09 had: Comparing linearly interpolated area function with raw distance_area txt from MATLAB
plot (c(0,29),c(0,700),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(unlist(allSpeakers.df[89,-(1:2)]), col="red")
vt02e <- read.table(paste(path,VTlist[9],"distance_area","had.txt",sep="\\"))
lines(vt02e[,2], col="blue")
title(main = "VT09 'had' vowel area functions")
legend(0,100,c("Interpolated on R and MATLAB","Interpolated in MATLAB only"), lty=c(1,1))
help(legend)
legend(0,100,c("Interpolated on R and MATLAB","Interpolated in MATLAB only"), lty=c(1,1), col=par("col"))
legend(0,100,c("Interpolated on R and MATLAB","Interpolated in MATLAB only"), lty=c(1,1), col=par("col"))
legend(0,100,c("Interpolated on R and MATLAB","Interpolated in MATLAB only"), lty=c(1,1), col=c("red","blue"))
plot (c(0,29),c(0,700),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(unlist(allSpeakers.df[89,-(1:2)]), col="red")
lines(vt02e[,2], col="blue")
title(main = "VT09 'had' vowel area functions")
legend(0,100,c("Interpolated on R and MATLAB","Interpolated in MATLAB only"), lty=c(1,1), col=c("red","blue"))
graphics.off() # close all graphics windows
plot (c(0,29),c(0,300),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(unlist(allSpeakers.df[14,-(1:2)]), col="red")
vt02e <- read.table(paste(path,VTlist[2],"distance_area","head.txt",sep="\\"))
lines(vt02e[,2], col="blue")
title(main = "VT02 'head' vowel area functions")
legend(0,40,c("Interpolated on R and MATLAB","Interpolated in MATLAB only"), lty=c(1,1), col=c("red","blue"))
# VT09 had: Comparing linearly interpolated area function with raw distance_area txt from MATLAB
plot (c(0,29),c(0,700),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(unlist(allSpeakers.df[89,-(1:2)]), col="red")
vt02e <- read.table(paste(path,VTlist[9],"distance_area","had.txt",sep="\\"))
lines(vt02e[,2], col="blue")
title(main = "VT09 'had' vowel area functions")
legend(0,100,c("Interpolated on R and MATLAB","Interpolated in MATLAB only"), lty=c(1,1), col=c("red","blue"))
plot (c(0,29),c(0,300),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(unlist(allSpeakers.df[14,-(1:2)]), col="red")
vt02e <- read.table(paste(path,VTlist[2],"distance_area","head.txt",sep="\\"))
lines(vt02e[,2], col="blue")
title(main = "VT02 'head' vowel area functions")
legend(0, 40, c("Interpolated on R","Raw area function"), lty=c(1,1), col=c("red","blue"))
# VT09 had: Comparing linearly interpolated area function with raw distance_area txt from MATLAB
plot (c(0,29),c(0,700),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(unlist(allSpeakers.df[89,-(1:2)]), col="red")
vt02e <- read.table(paste(path,VTlist[9],"distance_area","had.txt",sep="\\"))
lines(vt02e[,2], col="blue")
title(main = "VT09 'had' vowel area functions")
legend(0, 100, c("Interpolated on R","Raw area function"), lty=c(1,1), col=c("red","blue"))
cor.test(pc.VTareas$x[,1],pc.resfreqIV$x[,1])
pca
pca <- NULL
for(i in numVTs){
spk <- VTlist[i]
spkData <- allSpeakers.df[grep(spk, allSpeakers.df$spk),4:30]
spkPCA <- prcomp(~., data=na.omit(allSpeakers.df[,4:30]/maxArea), scale=T)
pca[i] <- spkPCA
}
pca[1]
allSpeakers.df
allSpeakers.df[1:11,4:30]
vt1pca <- prcomp(~., data=na.omit(allSpeakers.df[1:11,4:30]/maxArea), scale=T)
vt2pca <- prcomp(~., data=na.omit(allSpeakers.df[12:22,4:30]/maxArea), scale=T)
vt1pca
levels(vt1pca)
vt1pca$rotation
cor.test(vt1pca$rotation, vt2pca$rotation)
vt1pca$rotation[,1]
vt2pca$rotation[,1]
cor.test(vt1pca$rotation[,1], vt2pca$rotation[,1])
cor.test(vt1pca$rotation[,1], vt1pca$rotation[,1])
plot(vt2pca$rotation[,1])
lines(vt1pca$rotation[,1])
plot (c(0,29),c(0,300),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(vt1pca$rotation[,1], col="red")
lines(vvt2pca$rotation[,1], col="blue")
title(main = "PC1 for VT01 and VT02 area function data points")
legend(0, 40, c("VT01","VT02"), lty=c(1,1), col=c("red","blue"))
plot(type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(vt1pca$rotation[,1], col="red")
lines(vvt2pca$rotation[,1], col="blue")
title(main = "PC1 for VT01 and VT02 area function data points")
legend(0, 40, c("VT01","VT02"), lty=c(1,1), col=c("red","blue"))
plot(type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
plot(c(0,28),c(0,0.5),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
plot(c(0,28),c(0,0.5),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(vt1pca$rotation[,1], col="red")
lines(vvt2pca$rotation[,1], col="blue")
title(main = "PC1 for VT01 and VT02 area function data points")
legend(0, 40, c("VT01","VT02"), lty=c(1,1), col=c("red","blue"))
plot(c(0,28),c(-0.5,0.5),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(vt1pca$rotation[,1], col="red")
lines(vvt2pca$rotation[,1], col="blue")
title(main = "PC1 for VT01 and VT02 area function data points")
legend(0, 40, c("VT01","VT02"), lty=c(1,1), col=c("red","blue"))
plot(c(0,28),c(-0.5,0.5),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(vt1pca$rotation[,1], col="red")
lines(vt2pca$rotation[,1], col="blue")
title(main = "PC1 for VT01 and VT02 area function data points")
legend(0, 40, c("VT01","VT02"), lty=c(1,1), col=c("red","blue"))
plot(c(0,28),c(-0.4,0.4),type="n", xlab="Data point", ylab="Cross-sectional area (mm^2)")
lines(vt1pca$rotation[,1], col="red")
lines(vt2pca$rotation[,1], col="blue")
title(main = "PC1 for VT01 and VT02 area function data points")
legend(0, -0.3, c("VT01","VT02"), lty=c(1,1), col=c("red","blue"))
cor.test(vt1pca$rotation[,1], vt2pca$rotation[,1])
source('~/Part IV Project/R code/readAreaFunctions_2Set.R', echo=TRUE)
maxArea=apply(allSpeakers.df[,4:30],1,max)
maxArea
allSpeakers.df
setwd("~/Part IV Project/R code")
source('~/Part IV Project/R code/readAreaFunctions_1Set.R', echo=TRUE)
corr <- matrix(data = NA, nrow = numVTs-1, ncol = numVTs-1, byrow = TRUE)
colnames(corr) <- VTlist[-1]
rownames(corr) <- VTlist[-numVTs]
pvalues <- matrix(data = NA, nrow = numVTs-1, ncol = numVTs-1, byrow = TRUE)
colnames(pvalues) <- VTlist[-1]
rownames(pvalues) <- VTlist[-numVTs]
# Principal component number
p <- 1
# Maximum areas for normalising
maxArea=apply(allSpeakers.df[,4:30],1,max)
i = 1
j = 2
allSpeakers.df[((i-1)*10 + i):(i*10 + i),4:30]
allSpeakers.df[((i-1)*10 + i):(i*10 + i),4:30]/maxArea
allSpeakers.df[1,4:30]
maxArea[1,]
maxArea[1]
328.9317/483.738
64.07206/483.738
maxArea
maxArea[((i-1)*10 + i):(i*10 + i)]
maxArea[((j-1)*10 + j):(j*10 + j)]
allSpeakers.df[12,4:30]
allSpeakers.df[18,4:30]
allSpeakers.df[((i-1)*10 + i):(i*10 + i),4:30]/maxArea[((i-1)*10 + i):(i*10 + i)]
allSpeakers.df[((j-1)*10 + j):(j*10 + j),4:30]/maxArea[((j-1)*10 + j):(j*10 + j)]
allSpeakers.df[18,4:30]
257.8828/597.1644
allSpeakers.df[12,4:30]
maxArea[((j-1)*10 + j):(j*10 + j)]
allSpeakers.df[12,4:30]/maxArea[12]
allSpeakers.df[20:22,4:30]/maxArea[20:22]
source('~/Part IV Project/R code/correlations_inter.R', echo=TRUE)
allSpeakers.df[((i-1)*10 + i):(i*10 + i),4:30]/maxArea[((i-1)*10 + i):(i*10 + i)]
paste("correlationResults_inter_PC",p,".csv",sep="")
source('~/Part IV Project/R code/correlations_inter.R', echo=TRUE)
source('~/Part IV Project/R code/correlations_inter.R', echo=TRUE)
allSpeakers.df[((i-1)*10 + i):(i*10 + i),4:30]
maxArea
allSpeakers.df[((i-1)*10 + i):(i*10 + i),4:30]/maxArea
701.1199/483.738
637.9643/576.5401
736.2757/576.5401
637.9643/520.4126
637.9643/215.2934
11*28
source('~/Part IV Project/R code/correlations_inter.R', echo=TRUE)
source('~/Part IV Project/R code/correlations_inter.R', echo=TRUE)
source('~/Part IV Project/R code/correlations_inter.R', echo=TRUE)
source('~/Part IV Project/R code/correlations_inter.R', echo=TRUE)
i = 3
source('~/Part IV Project/R code/readAreaFunctions_2Set.R', echo=TRUE)
corr <- matrix(data = NA, nrow = numVTs-1, ncol = numVTs-1, byrow = TRUE)
colnames(corr) <- VTlist[-1]
rownames(corr) <- VTlist[-numVTs]
pvalues <- matrix(data = NA, nrow = numVTs-1, ncol = numVTs-1, byrow = TRUE)
colnames(pvalues) <- VTlist[-1]
rownames(pvalues) <- VTlist[-numVTs]
# Principal component number
p <- 1
# Normalise?
isNorm <- F
# Maximum areas for normalising. X1 is omitted since it is unreliable (MRI
# showed little of mouth opening at front of lips) and X29 omitted since it is
# the glottis which is always zero.
if (isNorm == T) { maxArea=apply(allSpeakers.df[,4:30],1,max) }
vtindex <- grep(VTlist[i], allSpeakers.df$spk)
set1index <- grep("Set1", allSpeakers.df$set)
index1 <- intersect(vtindex, set1index)
set1 <- allSpeakers.df[index1,4:30]
set1
allSpeakers.df[index1]
allSpeakers.df[index1,]
index1
maxArea[index1]
isNorm <- T
# Maximum areas for normalising. X1 is omitted since it is unreliable (MRI
# showed little of mouth opening at front of lips) and X29 omitted since it is
# the glottis which is always zero.
if (isNorm == T) { maxArea <- apply(allSpeakers.df[,4:30],1,max) }
maxArea[index1]
allSpeakers.df[index1[1:3],]
allSpeakers.df[index1[1:3],4:9]/maxArea[index1[1:3]]
maxArea[index1[1]]
239.4060/408.6148
280.9150/408.6148
177.4771/408.6148
329.5013/349.6042
208.9343/349.6042
409.7426/420.5008
105.7349/420.5008
?prcomp
allSpeakers.df
numVTs
debugSource('~/Part IV Project/R code/correlations_intra.R', echo=TRUE)
set1
set2
allSpeakers.df[index1,4:30]
allSpeakers.df[index1[3],4:30]
set1[3]
maxArea[index1[3]]
210.3195/227.4049
set1[index1[3]]
allSpeakers.df[index1[3],4:30]
210.3195/227.4049
set1[index1[3]]
maxArea[index1[3]]
210.3195/227.4049
166.2223/227.4049
maxArea[index1]
allSpeakers.df[index1,4:30]
allSpeakers.df[index1,4:30]/maxArea[index1]
210.3195/227.4049
166.2225/227.4049
VTlist
c("Corr", "P-value")
corr <- matrix(data = NA, nrow = 2, ncol = numVTs, byrow = TRUE)
colnames(corr) <- VTlist
rownames(corr) <- c("Corr", "P-value")
source('~/Part IV Project/R code/correlations_intra.R', echo=TRUE)
source('~/Part IV Project/R code/correlations_intra.R', echo=TRUE)
source('~/Part IV Project/R code/correlations_intra.R', echo=TRUE)
?append
rowlist <- []
rowlist <- c()
rowlist
# Table with VTs along columns, and two rows showing correlation estimate
# between two sets and p-value respectively, for each principal component.
corr <- matrix(data = NA, nrow = 2*np, ncol = numVTs, byrow = TRUE)
colnames(corr) <- VTlist
rowlist <- c()
for (i in 1:np) {
append(rowlist, paste("PC", np, " Corr"))
append(rowlist, paste("PC", np, " P-value"))
}
rownames(corr) <- rowlist
np <- 3
corr <- matrix(data = NA, nrow = 2*np, ncol = numVTs, byrow = TRUE)
colnames(corr) <- VTlist
rowlist <- c()
for (i in 1:np) {
append(rowlist, paste("PC", np, " Corr"))
append(rowlist, paste("PC", np, " P-value"))
}
rownames(corr) <- rowlist
corr
rowlist
np <- 3
# Table with VTs along columns, and two rows showing correlation estimate
# between two sets and p-value respectively, for each principal component.
corr <- matrix(data = NA, nrow = 2*np, ncol = numVTs, byrow = TRUE)
colnames(corr) <- VTlist
rowlist <- c()
for (i in 1:np) {
append(rowlist, paste("PC", np, " Corr"), after = length(rowlist))
append(rowlist, paste("PC", np, " P-value"), after = length(rowlist))
}
rownames(corr) <- rowlist
rowlist
rowlist <- 0
np <- 3
# Table with VTs along columns, and two rows showing correlation estimate
# between two sets and p-value respectively, for each principal component.
corr <- matrix(data = NA, nrow = 2*np, ncol = numVTs, byrow = TRUE)
colnames(corr) <- VTlist
rowlist <- 0
for (i in 1:np) {
rowlist[i*2-1] <- paste("PC", np, " Corr")
rowlist[i*2] <- paste("PC", np, " P-value")
}
rownames(corr) <- rowlist
corr
np <- 3
# Table with VTs along columns, and two rows showing correlation estimate
# between two sets and p-value respectively, for each principal component.
corr <- matrix(data = NA, nrow = 2*np, ncol = numVTs, byrow = TRUE)
colnames(corr) <- VTlist
rowlist <- 0
for (i in 1:np) {
rowlist[i*2-1] <- paste("PC", i, " Corr", sep="")
rowlist[i*2] <- paste("PC", i, " P-value", sep="")
}
rownames(corr) <- rowlist
corr
source('~/Part IV Project/R code/correlations_intra.R', echo=TRUE)
average(-0.4820885, 0.3571292)
(-0.4820885+0.3571292)/2
source('~/Part IV Project/R code/correlations_intra.R', echo=TRUE)
